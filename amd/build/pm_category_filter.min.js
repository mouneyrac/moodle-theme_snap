define(["jquery","core/log","core/ajax","core/notification"],function(a,b,c,d){var e=function(){var b=function(b,f){c.call([{methodname:"theme_snap_user_categories",args:{userid:2,action:b,categoryid:f},done:function(b){a(".courseinfo").css("display","none"),a(".menu_mycategory").removeClass("menu_mycategory_selected");var c="Categories: ",d=JSON.parse(b.listing);if(0==d.length)"none"==a(".site-overlay").css("display")&&a(".editcat").click();else{var f=!0;d.forEach(function(b,d){a("[data-categoryid="+b+"]").css("display","inline"),a(".menu_mycategory[data-categoryid="+b+"]").addClass("menu_mycategory_selected"),a("#menu_mycategory_li_"+b).attr("aria-checked","true"),f?f=!1:c+=", ";var e="#menu_mycategory_"+b;c+=a(e).text()})}e.text(c),a(".editcat").css("visibility","visible")},fail:function(a){d.exception(a)}}],!0,!0)},e=a("section#fixy-my-courses div h2"),f=function(a){var c=a.find(".menu_mycategory");c.hasClass("menu_mycategory_selected")?(a.attr("aria-checked",!1),c.removeClass("menu_mycategory_selected"),b("remove",c.attr("data-categoryid"))):(a.attr("aria-checked",!0),c.addClass("menu_mycategory_selected"),b("add",c.attr("data-categoryid")))},g=function(){f(a(this))};a(".menu_mycategory_li").click(g),a(".menu_mycategory_li").keypress(function(){(13==event.which||32==event.which)&&f(a(this))}),e.text("All courses");var h=function(){e.text("All Courses"),a(".editcat").css("visibility","hidden"),a(".courseinfo").css("display","inline-block"),a(".catfilter").css("display","inline"),a(".allcourses").css("display","none")};a(".allcourses").click(h),a(".allcourses").keypress(function(){(13==event.which||32==event.which)&&h()});var i=function(){e.text("Categories: "),b("listing"),a(".catfilter").css("display","none"),a(".allcourses").css("display","inline")};a(".catfilter").click(i),a(".catfilter").keypress(function(){(13==event.which||32==event.which)&&i()});var j=function(){"true"==a(".editcat").attr("aria-expanded")?a(".editcat").attr("aria-expanded","false"):a(".editcat").attr("aria-expanded","true")};a(".editcat").click(j),a(".editcat").keypress(function(){}),a(".editcat").keydown(function(){9==event.which&&"true"==a(".editcat").attr("aria-expanded")&&a(".pushy-content").focus()}),a("body").keydown(function(){27==event.which&&"true"==a(".editcat").attr("aria-expanded")&&a(".editcat").attr("aria-expanded","false")}),a(".site-overlay").click(function(){a(".editcat").attr("aria-expanded","false")})};return new e});